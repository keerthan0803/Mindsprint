<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Crop Yield Prediction</title>
  <style>
    :root{
      --bg: #f3fbf6;
      --card: #ffffff;
      --muted:#556b55;
      --accent:#2e8b57;
      --accent2: #b6e2c6;
      --glass: rgba(255,255,255,0.7);
      --radius:18px;
      --shadow: 0 8px 32px rgba(30,50,30,0.10);
      --shadow-hover: 0 16px 40px rgba(46,139,87,0.18);
      --gradient: linear-gradient(120deg, #e0ffe6 0%, #b6e2c6 100%);
      --gradient2: linear-gradient(90deg, #e0ffe6 0%, #f3fbf6 100%);
      color-scheme: light;
    }

    /* Dark + Forest Modes */
    [data-theme="dark"]{
      --bg: #000000;
      --card: #111111;
      --muted: #b6e2c6;
      --accent: #8fe0a2;
      --accent2: #222;
      --glass: rgba(20,20,20,0.7);
      --shadow: 0 8px 32px rgba(0,0,0,0.32);
      --shadow-hover: 0 16px 40px rgba(143,224,162,0.22);
    }
    [data-theme="forest"]{
      --bg: #1a2e22;
      --card: #223c2b;
      --muted: #d0f5e2;
      --accent: #7ed957;
      --accent2: #2e8b57;
      --glass: rgba(34,60,43,0.7);
      --shadow: 0 8px 32px rgba(46,139,87,0.22);
      --shadow-hover: 0 16px 40px rgba(126,217,87,0.22);
    }

    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: 'Inter', system-ui;
      background: var(--gradient2);
      padding: 28px;
      min-height:100vh;
    }

    .container{
      max-width: 900px;
      margin: 0 auto;
    }

    /* HEADER */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:16px 28px;
      background:var(--glass);
      border-radius:28px;
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
      margin-bottom: 25px;
    }

    .brand{display:flex;align-items:center;gap:12px;}
    .logo img{
      width:56px;height:56px;border-radius:16px;
      object-fit:contain;
    }
    .title{font-size:22px;font-weight:800;}
    .subtitle{font-size:13px;color:var(--muted);}

    /* FORM CARD */
    .card{
      background: var(--card);
      padding: 32px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(4px);
    }

    .heading{
      text-align:center;
      font-size:28px;
      font-weight:800;
      margin-bottom: 22px;
      color: var(--accent);
    }

    .form-group{
      display:flex;
      flex-direction:column;
      margin-bottom:16px;
    }
    label{
      font-weight:600;
      margin-bottom:6px;
    }
    input{
      padding:12px 14px;
      border-radius:12px;
      border:1.5px solid var(--accent2);
      background:var(--glass);
      outline:none;
      font-size:15px;
    }
    input:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(46,139,87,0.25);
    }

    button{
      margin-top:18px;
      width:100%;
      padding:14px;
      background:var(--accent);
      border:none;
      color:white;
      font-size:17px;
      border-radius:14px;
      cursor:pointer;
      transition:0.25s;
    }
    button:hover{
      background:#226f45;
      box-shadow: var(--shadow-hover);
    }

    /* OUTPUT */
    .output-box{
      margin-top:22px;
      padding:20px;
      background:var(--glass);
      border-radius:16px;
      border-left:5px solid var(--accent);
      font-size:18px;
      font-weight:600;
      display:none;
    }

    @media(max-width:600px){
      .card{padding:22px;}
      .heading{font-size:24px;}
    }
  </style>
</head>
<body data-theme="light">

  <div class="container">

    <!-- Header -->
    <header>
      <div class="brand">
        <div class="logo"><img src="/static/logo.png" alt="Logo"></div>
        <div>
          <div class="title">My Smart Farm</div>
          <div class="subtitle">smart farming ‚Äî soil to harvest</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <select id="langSelect" style="padding:8px;border-radius:12px;border:1px solid rgba(182,226,198,0.5);background:var(--glass);font-size:13px;cursor:pointer">
          <option value="en">English</option>
          <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
        </select>
      </div>
    </header>

    <!-- FORM CARD -->
    <div class="card">
      <div class="heading">üåæ Crop Yield Prediction</div>

      <div class="form-group">
        <label>Rainfall (mm)</label>
        <input id="rain" type="number" placeholder="Enter rainfall">
      </div>

      <div class="form-group">
        <label>Soil Quality Index</label>
        <input id="soil" type="number" placeholder="Enter soil index">
      </div>

      <div class="form-group">
        <label>Farm Size (hectares)</label>
        <input id="size" type="number" placeholder="Enter area">
      </div>

      <div class="form-group">
        <label>Sunlight (hours)</label>
        <input id="sun" type="number" placeholder="Enter sunlight hours">
      </div>

      <div class="form-group">
        <label>Fertilizers (kg)</label>
        <input id="fert" type="number" placeholder="Enter fertilizer amount">
      </div>

      <button onclick="predictYield()">Predict Crop Yield</button>

      <div id="output" class="output-box"></div>
    </div>

  </div>

  <script>
    // Language translations
    const translations = {
      en: {
        title: 'My Smart Farm',
        subtitle: 'smart farming ‚Äî soil to harvest',
        heading: 'üåæ Crop Yield Prediction',
        rainfall: 'Rainfall (mm)',
        rainfallPlaceholder: 'Enter rainfall',
        soilQuality: 'Soil Quality Index',
        soilPlaceholder: 'Enter soil index',
        farmSize: 'Farm Size (hectares)',
        farmPlaceholder: 'Enter farm size',
        sunlight: 'Sunlight Hours',
        sunlightPlaceholder: 'Enter sunlight hours',
        fertilizer: 'Fertilizer Used (kg)',
        fertilizerPlaceholder: 'Enter fertilizer amount',
        predictBtn: 'Predict Yield',
        fillFields: 'Please fill all fields.',
        predictedYield: 'Predicted Crop Yield:'
      },
      hi: {
        title: '‡§Æ‡§æ‡§á ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§´‡§æ‡§∞‡•ç‡§Æ',
        subtitle: '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§∏‡•á ‡§´‡§∏‡§≤ ‡§§‡§ï',
        heading: 'üåæ ‡§´‡§∏‡§≤ ‡§â‡§™‡§ú ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®',
        rainfall: '‡§µ‡§∞‡•ç‡§∑‡§æ (mm)',
        rainfallPlaceholder: '‡§µ‡§∞‡•ç‡§∑‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
        soilQuality: '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§∏‡•Ç‡§ö‡§ï‡§æ‡§Ç‡§ï',
        soilPlaceholder: '‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§∏‡•Ç‡§ö‡§ï‡§æ‡§Ç‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
        farmSize: '‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ (‡§π‡•á‡§ï‡•ç‡§ü‡•á‡§Ø‡§∞)',
        farmPlaceholder: '‡§ñ‡•á‡§§ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
        sunlight: '‡§∏‡•Ç‡§∞‡•ç‡§Ø ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ò‡§Ç‡§ü‡•á',
        sunlightPlaceholder: '‡§∏‡•Ç‡§∞‡•ç‡§Ø ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ò‡§Ç‡§ü‡•á ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
        fertilizer: '‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï (kg)',
        fertilizerPlaceholder: '‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§ï‡•Ä ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
        predictBtn: '‡§â‡§™‡§ú ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§≤‡§ó‡§æ‡§è‡§Ç',
        fillFields: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç‡•§',
        predictedYield: '‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§´‡§∏‡§≤ ‡§â‡§™‡§ú:'
      },
      te: {
        title: '‡∞Æ‡±à ‡∞∏‡±ç‡∞Æ‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞´‡∞æ‡∞∞‡±ç‡∞Æ‡±ç',
        subtitle: '‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø‡∞§‡±ã ‡∞™‡∞Ç‡∞ü ‡∞µ‡∞∞‡∞ï‡±Å',
        heading: 'üåæ ‡∞™‡∞Ç‡∞ü ‡∞¶‡∞ø‡∞ó‡±Å‡∞¨‡∞°‡∞ø ‡∞Ö‡∞Ç‡∞ö‡∞®‡∞æ',
        rainfall: '‡∞µ‡∞∞‡±ç‡∞∑‡∞™‡∞æ‡∞§‡∞Ç (mm)',
        rainfallPlaceholder: '‡∞µ‡∞∞‡±ç‡∞∑‡∞™‡∞æ‡∞§‡∞Ç ‡∞®‡∞Æ‡±ã‡∞¶‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        soilQuality: '‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞®‡∞æ‡∞£‡±ç‡∞Ø‡∞§ ‡∞∏‡±Ç‡∞ö‡∞ø‡∞ï',
        soilPlaceholder: '‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞∏‡±Ç‡∞ö‡∞ø‡∞ï ‡∞®‡∞Æ‡±ã‡∞¶‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        farmSize: '‡∞´‡∞æ‡∞∞‡±ç‡∞Æ‡±ç ‡∞™‡∞∞‡∞ø‡∞Æ‡∞æ‡∞£‡∞Ç (‡∞π‡±Ü‡∞ï‡±ç‡∞ü‡∞æ‡∞∞‡±ç‡∞≤‡±Å)',
        farmPlaceholder: '‡∞´‡∞æ‡∞∞‡±ç‡∞Æ‡±ç ‡∞™‡∞∞‡∞ø‡∞Æ‡∞æ‡∞£‡∞Ç ‡∞®‡∞Æ‡±ã‡∞¶‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        sunlight: '‡∞∏‡±Ç‡∞∞‡±ç‡∞Ø‡∞∞‡∞∂‡±ç‡∞Æ‡∞ø ‡∞ó‡∞Ç‡∞ü‡∞≤‡±Å',
        sunlightPlaceholder: '‡∞∏‡±Ç‡∞∞‡±ç‡∞Ø‡∞∞‡∞∂‡±ç‡∞Æ‡∞ø ‡∞ó‡∞Ç‡∞ü‡∞≤‡±Å ‡∞®‡∞Æ‡±ã‡∞¶‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        fertilizer: '‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø‡∞® ‡∞é‡∞∞‡±Å‡∞µ‡±Å‡∞≤‡±Å (kg)',
        fertilizerPlaceholder: '‡∞é‡∞∞‡±Å‡∞µ‡±Å‡∞≤ ‡∞™‡∞∞‡∞ø‡∞Æ‡∞æ‡∞£‡∞Ç ‡∞®‡∞Æ‡±ã‡∞¶‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        predictBtn: '‡∞¶‡∞ø‡∞ó‡±Å‡∞¨‡∞°‡∞ø ‡∞Ö‡∞Ç‡∞ö‡∞®‡∞æ ‡∞µ‡±á‡∞Ø‡∞Ç‡∞°‡∞ø',
        fillFields: '‡∞¶‡∞Ø‡∞ö‡±á‡∞∏‡∞ø ‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞´‡±Ä‡∞≤‡±ç‡∞°‡±ç‚Äå‡∞≤‡∞®‡±Å ‡∞®‡∞ø‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø.',
        predictedYield: '‡∞Ö‡∞Ç‡∞ö‡∞®‡∞æ ‡∞µ‡±á‡∞∏‡∞ø‡∞® ‡∞™‡∞Ç‡∞ü ‡∞¶‡∞ø‡∞ó‡±Å‡∞¨‡∞°‡∞ø:'
      }
    };

    function applyLanguage(lang) {
      const t = translations[lang];
      document.querySelector('.title').textContent = t.title;
      document.querySelector('.subtitle').textContent = t.subtitle;
      document.querySelector('.heading').textContent = t.heading;
      
      const labels = document.querySelectorAll('label');
      labels[0].textContent = t.rainfall;
      labels[1].textContent = t.soilQuality;
      labels[2].textContent = t.farmSize;
      labels[3].textContent = t.sunlight;
      labels[4].textContent = t.fertilizer;
      
      document.getElementById('rain').placeholder = t.rainfallPlaceholder;
      document.getElementById('soil').placeholder = t.soilPlaceholder;
      document.getElementById('size').placeholder = t.farmPlaceholder;
      document.getElementById('sun').placeholder = t.sunlightPlaceholder;
      document.getElementById('fert').placeholder = t.fertilizerPlaceholder;
      
      document.querySelector('button').textContent = t.predictBtn;
    }

    // Load saved language preference
    const langSelect = document.getElementById('langSelect');
    const savedLang = localStorage.getItem('msf-lang') || 'en';
    langSelect.value = savedLang;
    applyLanguage(savedLang);

    // Language change handler
    langSelect.addEventListener('change', () => {
      const selectedLang = langSelect.value;
      localStorage.setItem('msf-lang', selectedLang);
      applyLanguage(selectedLang);
    });

    async function predictYield(){
      let rain = Number(document.getElementById("rain").value);
      let soil = Number(document.getElementById("soil").value);
      let size = Number(document.getElementById("size").value);
      let sun  = Number(document.getElementById("sun").value);
      let fert = Number(document.getElementById("fert").value);

      if(!rain || !soil || !size || !sun || !fert){
        const currentLang = langSelect.value;
        const t = translations[currentLang];
        alert(t.fillFields);
        return;
      }

      try {
        const response = await fetch('/api/yield-predict', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            rainfall: rain,
            soil_quality: soil,
            farm_size: size,
            sunlight: sun,
            fertilizer: fert
          })
        });

        const result = await response.json();

        if (result.success) {
          const currentLang = langSelect.value;
          const t = translations[currentLang];
          document.getElementById("output").style.display = "block";
          document.getElementById("output").innerHTML = t.predictedYield + " <b>" + result.predicted_yield + " " + result.unit + "</b>";
        } else {
          alert("Error: " + (result.error || "Prediction failed"));
        }
      } catch (error) {
        console.error('Error:', error);
        alert("Failed to get prediction. Please try again.");
      }
    }
  </script>

</body>
</html>
